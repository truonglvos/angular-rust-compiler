[package]
name = "angular-compiler-cli"
version.workspace = true
edition.workspace = true

[lib]
name = "angular_compiler_cli"
crate-type = ["cdylib", "rlib"]

[[bin]]
name = "ngc"
path = "src/bin/ngc.rs"

[[bin]]
name = "ng-xi18n"
path = "src/bin/ng_xi18n.rs"

[[bin]]
name = "ng_bundle"
path = "src/bin/ng_bundle.rs"

[dependencies]
# Depend on compiler package
angular-compiler = { path = "../compiler" }
ts = { path = "../ts" }

# Workspace dependencies
serde = { workspace = true }
serde_json = { workspace = true }
indexmap = { workspace = true }
regex.workspace = true
once_cell = { workspace = true }
anyhow = { workspace = true }
thiserror = { workspace = true }
rayon = { workspace = true }
smallvec = { workspace = true }

# NAPI-RS for Node.js bindings (optional)
napi = { workspace = true, optional = true }
napi-derive = { workspace = true, optional = true }

# CLI-specific dependencies
clap = { version = "4.5", features = ["derive"] }
oxc_parser = "0.96.0"
oxc_allocator = "0.96.0"
oxc_span = "0.96.0"
oxc_semantic = "0.96.0"
oxc_ast = "0.96.0"
oxc_syntax = "0.96.0"
oxc_codegen = "0.96.0"
oxc_transformer = "0.96.0"
glob = "0.3"

[build-dependencies]
napi-build = "2.1"

[features]
default = []
napi-bindings = ["napi", "napi-derive"]

[profile.release]
opt-level = 3
lto = true
codegen-units = 1
strip = true

